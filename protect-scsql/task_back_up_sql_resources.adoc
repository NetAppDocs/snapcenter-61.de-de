---
permalink: protect-scsql/task_back_up_sql_resources.html 
sidebar: sidebar 
keywords: backup 
summary: Wenn eine Ressource noch nicht Teil einer Ressourcengruppe ist, können Sie die Ressource von der Seite „Ressourcen“ aus sichern. 
---
= Sichern von SQL-Ressourcen
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Wenn eine Ressource noch nicht Teil einer Ressourcengruppe ist, können Sie die Ressource von der Seite „Ressourcen“ aus sichern.

.Informationen zu diesem Vorgang
* Um den Sicherungsvorgang zu optimieren, sollten Sie einen Reverse-Lookup-Datensatz der Windows-Clusternamen und IP-Adressen im DNS-Server erstellen.
* Für die Authentifizierung mit Windows-Anmeldeinformationen müssen Sie Ihre Anmeldeinformationen einrichten, bevor Sie die Plug-Ins installieren.
* Für die Authentifizierung der SQL Server-Instanz müssen Sie die Anmeldeinformationen nach der Installation der Plug-Ins hinzufügen.
* Für die gMSA-Authentifizierung müssen Sie gMSA einrichten, während Sie den Host bei SnapCenter auf der Seite *Host hinzufügen* oder *Host ändern* registrieren, um gMSA zu aktivieren und zu verwenden.
* Wenn der Host mit gMSA hinzugefügt wird und das gMSA über Anmelde- und Systemadministratorrechte verfügt, darf das gMSA eine Verbindung zur SQL-Instanz herstellen.
+
** SnapCenter überprüft, ob die Authentifizierung für SQL-Instanzen konfiguriert ist.  Wenn die Authentifizierung konfiguriert ist, wird mit diesen Anmeldeinformationen auf die SQL-Instanz zugegriffen.
** Wenn die Authentifizierung nicht konfiguriert ist, verwenden Sie gMSA, um zu prüfen, ob das SQL-Plug-In derzeit ausgeführt wird.  Wenn das Plug-In aktiv ist, wird es verwendet, um eine Verbindung zur SQL-Instanz herzustellen.
** Der Zugriff auf die SQL-Instanz erfolgt über die Windows-Anmeldeinformationsauthentifizierung, wenn weder die Authentifizierung für SQL-Instanzen konfiguriert ist noch das Plug-In betriebsbereit ist.




[role="tabbed-block"]
====
.SnapCenter -Benutzeroberfläche
--
.Schritte
. Wählen Sie im linken Navigationsbereich *Ressourcen* und wählen Sie dann das entsprechende Plug-In aus der Liste aus.
. Wählen Sie auf der Seite „Ressourcen“ aus der Dropdown-Liste „Anzeigen“ die Option „Datenbank“ oder „Instanz“ oder „Verfügbarkeitsgruppe“ aus.
+
.. Wählen Sie die Datenbank, Instanz oder Verfügbarkeitsgruppe aus, die Sie sichern möchten.
+
Wenn Sie eine Sicherungskopie einer Instanz erstellen, sind die Informationen zum letzten Sicherungsstatus oder der Zeitstempel dieser Instanz auf der Ressourcenseite nicht verfügbar.

+
In der Topologieansicht können Sie nicht unterscheiden, ob es sich bei dem Sicherungsstatus, dem Zeitstempel oder der Sicherung um eine Instanz oder eine Datenbank handelt.



. Aktivieren Sie auf der Seite „Ressourcen“ das Kontrollkästchen *Benutzerdefiniertes Namensformat für Snapshot-Kopie* und geben Sie dann ein benutzerdefiniertes Namensformat ein, das Sie für den Snapshot-Namen verwenden möchten.
+
Beispielsweise customtext_policy_hostname oder resource_hostname.  Standardmäßig wird dem Snapshot-Namen ein Zeitstempel angehängt.

. Führen Sie auf der Seite „Richtlinien“ die folgenden Aufgaben aus:
+
.. Wählen Sie im Abschnitt „Richtlinien“ eine oder mehrere Richtlinien aus der Dropdownliste aus.
+
Sie können eine Richtlinie erstellen, indem Sie * auswählen.image:../media/add_policy_from_resourcegroup.gif["Richtlinienformular-Ressourcengruppe hinzufügen"] * um den Richtlinienassistenten zu starten.

+
Im Abschnitt *Zeitpläne für ausgewählte Richtlinien konfigurieren* werden die ausgewählten Richtlinien aufgelistet.

.. Wählen *image:../media/add_policy_from_resourcegroup.gif["Richtlinienformular-Ressourcengruppe hinzufügen"] * in der Spalte „Zeitpläne konfigurieren“ für die Richtlinie, für die Sie einen Zeitplan konfigurieren möchten.
.. Im Fenster *Zeitpläne für Richtlinie hinzufügen* `policy_name` Dialogfeld, konfigurieren Sie den Zeitplan und wählen Sie dann *OK*.
+
Hier `policy_name` ist der Name der Richtlinie, die Sie ausgewählt haben.

+
Die konfigurierten Zeitpläne werden in der Spalte *Angewandte Zeitpläne* aufgelistet.

.. Wählen Sie *Microsoft SQL Server-Scheduler verwenden* und wählen Sie dann aus der Dropdown-Liste *Scheduler-Instanz* die Scheduler-Instanz aus, die der Planungsrichtlinie zugeordnet ist.


. Führen Sie auf der Seite „Verifizierung“ die folgenden Schritte aus:
+
.. Wählen Sie den Verifizierungsserver aus der Dropdown-Liste *Verifizierungsserver* aus.
+
Sie können mehrere Verifizierungsserver auswählen (lokaler Host oder Remote-Host).

+

NOTE: Die Version des Verifizierungsservers sollte gleich oder höher sein als die Version der Edition des SQL-Servers, auf dem die primäre Datenbank gehostet wird.

.. Wählen Sie *Sekundäre Locatoren laden, um Backups auf dem sekundären Speichersystem zu überprüfen*, um Ihre Backups auf dem sekundären Speichersystem zu überprüfen.
.. Wählen Sie die Richtlinie aus, für die Sie Ihren Überprüfungszeitplan konfigurieren möchten, und wählen Sie dann *image:../media/add_policy_from_resourcegroup.gif["Richtlinienformular-Ressourcengruppe hinzufügen"] *.
.. Führen Sie im Dialogfeld „Verifizierungszeitpläne hinzufügen _Richtlinienname_“ die folgenden Aktionen aus:
+
|===
| Wenn Sie wollen... | Machen Sie Folgendes... 


 a| 
Führen Sie nach der Sicherung eine Überprüfung durch
 a| 
Wählen Sie *Überprüfung nach Sicherung ausführen*.



 a| 
Planen Sie eine Überprüfung
 a| 
Wählen Sie *Geplante Überprüfung ausführen*.

|===
+

NOTE: Wenn der Überprüfungsserver keine Speicherverbindung hat, schlägt der Überprüfungsvorgang mit folgendem Fehler fehl: „Datenträger konnte nicht eingebunden werden.“

.. Wählen Sie *OK*.
+
Die konfigurierten Zeitpläne werden in der Spalte „Angewandte Zeitpläne“ aufgelistet.



. Wählen Sie auf der Benachrichtigungsseite aus der Dropdownliste *E-Mail-Einstellungen* die Szenarien aus, in denen Sie die E-Mails senden möchten.
+
Sie müssen außerdem die E-Mail-Adressen des Absenders und des Empfängers sowie den Betreff der E-Mail angeben.  Wenn Sie den Bericht über den an der Ressourcengruppe durchgeführten Vorgang anhängen möchten, wählen Sie *Jobbericht anhängen*.

+

NOTE: Für die E-Mail-Benachrichtigung müssen Sie die SMTP-Serverdetails entweder über die GUI oder den PowerShell-Befehl „Set-SmSmtpServer“ angegeben haben.

. Überprüfen Sie die Zusammenfassung und wählen Sie dann *Fertig*.
+
Die Seite „Datenbanktopologie“ wird angezeigt.

. Wählen Sie *Jetzt sichern*.
. Führen Sie auf der Seite „Sichern“ die folgenden Schritte aus:
+
.. Wenn Sie mehrere Richtlinien auf die Ressource angewendet haben, wählen Sie aus der Dropdownliste *Richtlinie* die Richtlinie aus, die Sie für die Sicherung verwenden möchten.
+
Wenn die für die On-Demand-Sicherung ausgewählte Richtlinie mit einem Sicherungszeitplan verknüpft ist, werden die On-Demand-Sicherungen basierend auf den für den Zeitplantyp angegebenen Aufbewahrungseinstellungen aufbewahrt.

.. Wählen Sie *Nach Sicherung überprüfen*, um Ihre Sicherung zu überprüfen.
.. Wählen Sie *Backup*.
+

NOTE: Sie sollten den im Windows-Scheduler oder SQL Server-Agent erstellten Sicherungsauftrag nicht umbenennen.

+
Wenn die für die On-Demand-Sicherung ausgewählte Richtlinie mit einem Sicherungszeitplan verknüpft ist, werden die On-Demand-Sicherungen basierend auf den für den Zeitplantyp angegebenen Aufbewahrungseinstellungen aufbewahrt.

+
Es wird eine implizite Ressourcengruppe erstellt.  Sie können dies anzeigen, indem Sie den entsprechenden Benutzer oder die entsprechende Gruppe auf der Seite „Benutzerzugriff“ auswählen.  Der implizite Ressourcengruppentyp ist „Ressource“.



. Überwachen Sie den Vorgangsfortschritt, indem Sie *Überwachen* > *Jobs* auswählen.


.Nach Abschluss
* In MetroCluster -Konfigurationen kann SnapCenter nach einem Failover möglicherweise keine Schutzbeziehung erkennen.
+
https://kb.netapp.com/Advice_and_Troubleshooting/Data_Protection_and_Security/SnapCenter/Unable_to_detect_SnapMirror_or_SnapVault_relationship_after_MetroCluster_failover["SnapMirror oder SnapVault -Beziehung kann nach MetroCluster Failover nicht erkannt werden"]

* Wenn Sie Anwendungsdaten auf VMDKs sichern und die Java-Heap-Größe für das SnapCenter Plug-in for VMware vSphere nicht groß genug ist, schlägt die Sicherung möglicherweise fehl.  Um die Java-Heap-Größe zu erhöhen, suchen Sie die Skriptdatei /opt/netapp/init_scripts/scvservice.  In diesem Skript `do_start method` Der Befehl startet den SnapCenter VMware-Plug-In-Dienst.  Aktualisieren Sie diesen Befehl wie folgt: `Java -jar -Xmx8192M -Xms4096M` .


.Ähnliche Informationen
link:task_create_backup_policies_for_sql_server_databases.html["Erstellen von Sicherungsrichtlinien für SQL Server-Datenbanken"]

https://kb.netapp.com/Advice_and_Troubleshooting/Data_Protection_and_Security/SnapCenter/Clone_operation_might_fail_or_take_longer_time_to_complete_with_default_TCP_TIMEOUT_value["Sicherungsvorgänge schlagen aufgrund der Verzögerung im TCP_TIMEOUT mit einem MySQL-Verbindungsfehler fehl"]

https://kb.netapp.com/Advice_and_Troubleshooting/Data_Protection_and_Security/SnapCenter/Backup_fails_with_Windows_scheduler_error["Die Sicherung schlägt mit einem Windows-Planerfehler fehl"]

https://kb.netapp.com/Advice_and_Troubleshooting/Data_Protection_and_Security/SnapCenter/Quiesce_or_grouping_resources_operations_fail["Vorgänge zum Stilllegen oder Gruppieren von Ressourcen schlagen fehl"]

--
.PowerShell-Cmdlets
--
.Schritte
. Initiieren Sie mithilfe des Cmdlets Open-SmConnection eine Verbindungssitzung mit dem SnapCenter -Server für einen angegebenen Benutzer.
+
[listing]
----
Open-smconnection  -SMSbaseurl  https://snapctr.demo.netapp.com:8146
----
+
Die Eingabeaufforderung für Benutzername und Kennwort wird angezeigt.

. Erstellen Sie eine Sicherungsrichtlinie mithilfe des Cmdlets Add-SmPolicy.
+
In diesem Beispiel wird eine neue Sicherungsrichtlinie mit dem SQL-Sicherungstyp „FullBackup“ erstellt:

+
[listing]
----
PS C:\> Add-SmPolicy -PolicyName TESTPolicy
-PluginPolicyType SCSQL -PolicyType Backup
-SqlBackupType FullBackup -Verbose
----
+
In diesem Beispiel wird eine neue Sicherungsrichtlinie mit dem Sicherungstyp „CrashConsistent“ für das Windows-Dateisystem erstellt:

+
[listing]
----
PS C:\> Add-SmPolicy -PolicyName FileSystemBackupPolicy
-PluginPolicyType SCW -PolicyType Backup
-ScwBackupType CrashConsistent -Verbose
----
. Ermitteln Sie Hostressourcen mithilfe des Cmdlets „Get-SmResources“.
+
Dieses Beispiel ermittelt die Ressourcen für das Microsoft SQL-Plug-In auf dem angegebenen Host:

+
[listing]
----
C:\PS>PS C:\> Get-SmResources -HostName vise-f6.sddev.mycompany.com
-PluginCode SCSQL
----
+
Dieses Beispiel ermittelt die Ressourcen für Windows-Dateisysteme auf dem angegebenen Host:

+
[listing]
----
C:\PS>PS C:\> Get-SmResources -HostName vise2-f6.sddev.mycompany.com
-PluginCode SCW
----
. Fügen Sie SnapCenter mithilfe des Cmdlets Add-SmResourceGroup eine neue Ressourcengruppe hinzu.
+
In diesem Beispiel wird eine neue SQL-Datenbank-Sicherungsressourcengruppe mit der angegebenen Richtlinie und den angegebenen Ressourcen erstellt:

+
[listing]
----
PS C:\> Add-SmResourceGroup -ResourceGroupName AccountingResource
-Resources @{"Host"="visef6.org.com";
"Type"="SQL Database";"Names"="vise-f6\PayrollDatabase"}
-Policies "BackupPolicy"
----
+
In diesem Beispiel wird eine neue Ressourcengruppe zur Sicherung des Windows-Dateisystems mit der angegebenen Richtlinie und den angegebenen Ressourcen erstellt:

+
[listing]
----
PS C:\> Add-SmResourceGroup -ResourceGroupName EngineeringResource
-PluginCode SCW -Resources @{"Host"="WIN-VOK20IKID5I";
"Type"="Windows Filesystem";"Names"="E:\"}
-Policies "EngineeringBackupPolicy"
----
. Starten Sie einen neuen Sicherungsauftrag mithilfe des Cmdlets New-SmBackup.
+
[listing]
----
PS C:> New-SmBackup -ResourceGroupName PayrollDataset -Policy FinancePolicy
----
. Zeigen Sie den Status des Sicherungsauftrags mithilfe des Cmdlets Get-SmBackupReport an.
+
In diesem Beispiel wird ein Job-Zusammenfassungsbericht aller Jobs angezeigt, die am angegebenen Datum ausgeführt wurden:

+
[listing]
----
PS C:\> Get-SmJobSummaryReport -Date '1/27/2016'
----


Informationen zu den mit dem Cmdlet verwendbaren Parametern und deren Beschreibungen erhalten Sie durch Ausführen von _Get-Help command_name_. Alternativ können Sie auch auf die https://docs.netapp.com/us-en/snapcenter-cmdlets/index.html["Referenzhandbuch für SnapCenter -Software-Cmdlets"^] .

--
====