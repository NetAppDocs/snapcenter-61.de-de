---
permalink: protect-db2/clone-ibm-db2-backup.html 
sidebar: sidebar 
keywords: SnapCenter Plug-in for IBM Db2,run as 
summary: Sie können SnapCenter verwenden, um ein Backup zu klonen.  Sie können von einer primären oder sekundären Sicherung klonen. 
---
= Klonen einer IBM Db2-Sicherung
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Sie können SnapCenter verwenden, um ein Backup zu klonen.  Sie können von einer primären oder sekundären Sicherung klonen.

.Bevor Sie beginnen
* Sie sollten die Ressourcen oder Ressourcengruppe gesichert haben.
* Sie sollten sicherstellen, dass die Aggregate, die die Volumes hosten, in der Liste der zugewiesenen Aggregate der Storage Virtual Machine (SVM) enthalten sind.
* Beim Erstellen eines Klons für Db2 auf einem alternativen Host müssen Sie für den Mountpfad des Klons eine n-1-Verzeichnisstruktur erstellen, die mit dem ursprünglichen Mountpfad auf dem anderen Host identisch ist.  Der Mount-Pfad sollte über die Ausführungsberechtigung _755_ verfügen.
* Bei Befehlen vor oder nach dem Klonen sollten Sie überprüfen, ob die Befehle in der Befehlsliste vorhanden sind, die auf dem Plug-In-Host unter den folgenden Pfaden verfügbar ist:
+
** Standardspeicherort auf dem Windows-Host: _C:\Programme\ NetApp\ SnapCenter\Snapcenter Plug-in Creator\etc\allowed_commands.config_
** Standardspeicherort auf dem Linux-Host: _/opt/ NetApp/snapcenter/scc/etc/allowed_commands.config_





NOTE: Wenn die Befehle nicht in der Befehlsliste vorhanden sind, schlägt der Vorgang fehl.

.Informationen zu diesem Vorgang
* Informationen zu FlexClone -Volume-Split-Vorgängen finden Sie unterhttps://docs.netapp.com/us-en/ontap/volumes/split-flexclone-from-parent-task.html["Teilen Sie ein FlexClone -Volume von seinem übergeordneten Volume"] .
* Bei ONTAP 9.12.1 und niedrigeren Versionen erben die im Rahmen der Wiederherstellung aus den SnapLock Vault-Snapshots erstellten Klone die Ablaufzeit von SnapLock Vault. Der Speicheradministrator sollte die Klone nach Ablauf des SnapLock manuell bereinigen.


[role="tabbed-block"]
====
.SnapCenter -Benutzeroberfläche
--
.Schritte
. Klicken Sie im linken Navigationsbereich auf *Ressourcen* und wählen Sie dann das entsprechende Plug-In aus der Liste aus.
. Filtern Sie auf der Seite „Ressourcen“ die Ressourcen aus der Dropdown-Liste *Anzeigen* basierend auf dem Ressourcentyp.
+
Die Ressourcen werden zusammen mit Informationen wie Typ, Host, zugehörigen Ressourcengruppen und Richtlinien sowie Status angezeigt.

. Wählen Sie die Ressource oder Ressourcengruppe aus.
+
Sie müssen eine Ressource auswählen, wenn Sie eine Ressourcengruppe auswählen.

+
Die Topologieseite der Ressource oder Ressourcengruppe wird angezeigt.

. Wählen Sie in der Ansicht „Kopien verwalten“ *Backups* entweder aus dem primären oder sekundären (gespiegelten oder im Tresor gespeicherten) Speichersystem aus.
. Wählen Sie die Datensicherung aus der Tabelle aus und klicken Sie anschließend aufimage:../media/clone_icon.gif["Klonsymbol"] .
. Führen Sie auf der Seite „Standort“ die folgenden Aktionen aus:
+
|===
| Für dieses Feld... | Machen Sie Folgendes... 


 a| 
Server klonen
 a| 
Wählen Sie einen Host aus, auf dem der Klon erstellt werden soll.



 a| 
Zielklon-Instanz
 a| 
Geben Sie die Ziel-ID der Db2-Kloninstanz ein, die aus den vorhandenen Sicherungen geklont werden soll.

Dies gilt nur für Ressourcen des Speichertyps ANF.



 a| 
Name des Zielklons
 a| 
Geben Sie den Namen des Klons ein.

Dies gilt nur für Db2-Datenbankressourcen.



 a| 
NFS-Export-IP-Adresse
 a| 
Geben Sie die IP-Adressen oder Hostnamen ein, auf die die geklonten Volumes exportiert werden.

Dies gilt nur für Ressourcen des NFS-Speichertyps.



 a| 
Max. Durchsatz des Kapazitätspools (MiB/s)
 a| 
Geben Sie den maximalen Durchsatz eines Kapazitätspools ein.

|===
. Führen Sie auf der Seite „Skripts“ die folgenden Schritte aus:
+

NOTE: Die Skripte werden auf dem Plug-in-Host ausgeführt.

+
.. Geben Sie die Befehle für „Pre-Clone“ oder „Post-Clone“ ein, die vor bzw. nach dem Klonvorgang ausgeführt werden sollen.
+
*** Befehl vor dem Klonen: Löschen Sie vorhandene Datenbanken mit demselben Namen
*** Befehl nach dem Klonen: Überprüfen Sie eine Datenbank oder starten Sie eine Datenbank.


.. Geben Sie den Mount-Befehl ein, um ein Dateisystem auf einem Host zu mounten.
+
Mount-Befehl für ein Volume oder einen Qtree auf einer Linux-Maschine:

+
Beispiel für NFS: `mount VSERVER_DATA_IP:%VOLUME_NAME_Clone /mnt`



. Wählen Sie auf der Benachrichtigungsseite aus der Dropdownliste *E-Mail-Einstellungen* die Szenarien aus, in denen Sie die E-Mails senden möchten.
+
Sie müssen außerdem die E-Mail-Adressen des Absenders und des Empfängers sowie den Betreff der E-Mail angeben.

. Überprüfen Sie die Zusammenfassung und klicken Sie dann auf *Fertig*.
. Überwachen Sie den Vorgangsfortschritt, indem Sie auf *Überwachen* > *Jobs* klicken.


.Nach Abschluss
Nach dem Klonen der automatisch erkannten Db2-Ressourcen wird die geklonte Ressource als manuelle Ressource markiert.  Klicken Sie auf *Ressourcen aktualisieren*, um die geklonte Db2-Ressource wiederherzustellen.  Wenn Sie den Klon löschen, werden auch der Speicher und der Host bereinigt.

Wenn Sie die Ressourcen nach dem Klonvorgang nicht aktualisieren und versuchen, den Klon zu löschen, werden der Speicher und der Host nicht bereinigt.  Sie müssen die Einträge manuell in der fstab löschen.

--
.PowerShell-Cmdlets
--
.Schritte
. Initiieren Sie mithilfe des Cmdlets Open-SmConnection eine Verbindungssitzung mit dem SnapCenter -Server für einen angegebenen Benutzer.
+
[listing]
----
Open-SmConnection  -SMSbaseurl  https://snapctr.demo.netapp.com:8146
----
. Listen Sie die Sicherungen auf, die mit dem Cmdlet Get-SmBackup oder Get-SmResourceGroup geklont werden können.
+
Dieses Beispiel zeigt Informationen zu allen verfügbaren Backups an:

+
[listing]
----
C:\PS>PS C:\> Get-SmBackup

BackupId   BackupName                     BackupTime   BackupType
--------   ----------                     ----------   ----------
1          Payroll Dataset_vise-f6_08...  8/4/2015     Full Backup
                                          11:02:32 AM

2          Payroll Dataset_vise-f6_08...  8/4/2015
                                          11:23:17 AM
----
+
In diesem Beispiel werden Informationen zu einer angegebenen Ressourcengruppe, ihren Ressourcen und zugehörigen Richtlinien angezeigt:

+
[listing]
----
PS C:\> Get-SmResourceGroup -ListResources –ListPolicies

Description :
CreationTime : 8/4/2015 3:44:05 PM
ModificationTime : 8/4/2015 3:44:05 PM
EnableEmail : False
EmailSMTPServer :
EmailFrom :
EmailTo :
EmailSubject :
EnableSysLog : False
ProtectionGroupType : Backup
EnableAsupOnFailure : False
Policies : {FinancePolicy}
HostResourceMaping : {}
Configuration : SMCoreContracts.SmCloneConfiguration
LastBackupStatus :
VerificationServer :
EmailBody :
EmailNotificationPreference : Never
VerificationServerInfo : SMCoreContracts.SmVerificationServerInfo
SchedulerSQLInstance :
CustomText :
CustomSnapshotFormat :
SearchResources : False
ByPassCredential : False
IsCustomSnapshot :
MaintenanceStatus : Production
PluginProtectionGroupTypes : {SMSQL}
Name : Payrolldataset
Type : Group
Id : 1
Host :
UserName :
Passphrase :
Deleted : False
Auth : SMCoreContracts.SmAuth
IsClone : False
CloneLevel : 0
ApplySnapvaultUpdate : False
ApplyRetention : False
RetentionCount : 0
RetentionDays : 0
ApplySnapMirrorUpdate : False
SnapVaultLabel :
MirrorVaultUpdateRetryCount : 7
AppPolicies : {}
Description : FinancePolicy
PreScriptPath :
PreScriptArguments :
PostScriptPath :
PostScriptArguments :
ScriptTimeOut : 60000
DateModified : 8/4/2015 3:43:30 PM
DateCreated : 8/4/2015 3:43:30 PM
Schedule : SMCoreContracts.SmSchedule
PolicyType : Backup
PluginPolicyType : SMSQL
Name : FinancePolicy
Type :
Id : 1
Host :
UserName :
Passphrase :
Deleted : False
Auth : SMCoreContracts.SmAuth
IsClone : False
CloneLevel : 0
clab-a13-13.sddev.lab.netapp.com
DatabaseGUID :
SQLInstance : clab-a13-13
DbStatus : AutoClosed
DbAccess : eUndefined
IsSystemDb : False
IsSimpleRecoveryMode : False
IsSelectable : True
SqlDbFileGroups : {}
SqlDbLogFiles : {}
AppFileStorageGroups : {}
LogDirectory :
AgName :
Version :
VolumeGroupIndex : -1
IsSecondary : False
Name : TEST
Type : SQL Database
Id : clab-a13-13\TEST
Host : clab-a13-13.sddev.mycompany.com
UserName :
Passphrase :
Deleted : False
Auth : SMCoreContracts.SmAuth
IsClone : False
----
. Starten Sie einen Klonvorgang aus einer vorhandenen Sicherung mithilfe des Cmdlets New-SmClone.
+
Dieses Beispiel erstellt einen Klon aus einem angegebenen Backup mit allen Protokollen:

+
[listing]
----
PS C:\> New-SmClone
-BackupName payroll_dataset_vise-f3_08-05-2015_15.28.28.9774
-Resources @{"Host"="vise-f3.sddev.mycompany.com";
"Type"="SQL Database";"Names"="vise-f3\SQLExpress\payroll"}
-CloneToInstance vise-f3\sqlexpress -AutoAssignMountPoint
-Suffix _clonefrombackup
-LogRestoreType All -Policy clonefromprimary_ondemand

PS C:> New-SmBackup -ResourceGroupName PayrollDataset -Policy FinancePolicy
----
+
In diesem Beispiel wird ein Klon einer angegebenen Microsoft SQL Server-Instanz erstellt:

+
[listing]
----
PS C:\> New-SmClone
-BackupName "BackupDS1_NY-VM-SC-SQL_12-08-2015_09.00.24.8367"
-Resources @{"host"="ny-vm-sc-sql";"Type"="SQL Database";
"Names"="ny-vm-sc-sql\AdventureWorks2012_data"}
-AppPluginCode SMSQL -CloneToInstance "ny-vm-sc-sql"
-Suffix _CLPOSH -AssignMountPointUnderPath "C:\SCMounts"
----
. Zeigen Sie den Status des Klonauftrags mithilfe des Cmdlets Get-SmCloneReport an.
+
Dieses Beispiel zeigt einen Klonbericht für die angegebene Job-ID an:

+
[listing]
----
PS C:\> Get-SmCloneReport -JobId 186

SmCloneId : 1
SmJobId : 186
StartDateTime : 8/3/2015 2:43:02 PM
EndDateTime : 8/3/2015 2:44:08 PM
Duration : 00:01:06.6760000
Status : Completed
ProtectionGroupName : Draper
SmProtectionGroupId : 4
PolicyName : OnDemand_Clone
SmPolicyId : 4
BackupPolicyName : OnDemand_Full_Log
SmBackupPolicyId : 1
CloneHostName : SCSPR0054212005.mycompany.com
CloneHostId : 4
CloneName : Draper__clone__08-03-2015_14.43.53
SourceResources : {Don, Betty, Bobby, Sally}
ClonedResources : {Don_DRAPER, Betty_DRAPER, Bobby_DRAPER,
                   Sally_DRAPER}
----


Informationen zu den mit dem Cmdlet verwendbaren Parametern und deren Beschreibungen erhalten Sie durch Ausführen von _Get-Help command_name_. Alternativ können Sie auch auf die https://docs.netapp.com/us-en/snapcenter-cmdlets/index.html["Referenzhandbuch für SnapCenter -Software-Cmdlets"^] .

--
====